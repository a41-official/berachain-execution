version: "1.0"

services:
  #             _   _
  #   __ _  ___| |_| |__
  #  / _` |/ _ \ __| '_ \
  # | (_| |  __/ |_| | | |
  #  \__, |\___|\__|_| |_|
  #  |___/
  geth:
    image: ethereum/client-go:${GETH_VERSION:-v1.14.4}
    ports:
      - ${EC_PORT_P2P:-30303}:30303/tcp # P2P TCP
      - ${EC_PORT_P2P:-30303}:30303/udp # P2P UDP
      - ${EC_PORT_HTTP:-8545}:8545 # JSON-RPC
      - ${EC_PORT_ENGINE:-8551}:8551 # ENGINE-API
      - ${EC_PORT_METRIC:-6060}:6060 # METRICS
    command: |
      --http
      --http.addr=0.0.0.0
      --http.port=8545
      --http.vhosts="*"
      --http.api="db,eth,net,engine,rpc,web3"
      --ws
      --ws.addr=0.0.0.0
      --ws.port=8546
      --ws.origins="*"
      --ws.api="eth,net,web3"
      --authrpc.jwtsecret="/root/jwt/jwt.hex"
      --authrpc.addr=0.0.0.0
      --authrpc.port=8551
      --authrpc.vhosts="*"
      --metrics
      --metrics.addr=0.0.0.0
      --metrics.port=6060
      --bootnodes=${EC_BOOTNODES:-enode://1c641f22b7bec7b6a9129f81cd23086020f43bf7aa53dbdbfc8bdcbdd8a17da95ac453cfa72608ac57febe58b726bcc9abc0c2b84aced113e75635bea848295c@peer.bartio.bera.bh.rocks:30303}
      --networkid=${EC_NETWORK_ID:-80086}
      --snapshot=false
      --syncmode=snap
    volumes:
      - ./data/geth:/root/.ethereum
      - ${EC_JWT_PATH:-~/.beacond/config/jwt.hex}:/root/jwt/jwt.hex
    restart: unless-stopped